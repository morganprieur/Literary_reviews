<!-- <Doctype html>  -->

<!-- blog/templates/auth/home.html --> 
{% extends 'base.html' %}

    {% block content %} 

    <div class="w3-row"> 
        <div class="w3-col m6"> 
            <form action="../create_ticket" method="GET"> 
                {% csrf_token %} 
                <button type="submit">Créer un ticket</button> 
            </form> 
        </div>
        <div class="w3-col m6"> 
            <form action="../create_review" method="GET"> 
                {% csrf_token %} 
                <button type="submit">Créer une revue</button> 
            </form> 
        </div>
    </div> 


    <div class="cadre"> 
        <h5 class="w3-center">Flux</h5>
        {% for r in reviews %} 
            <hr> 

            <div class="review"> 
                {% if r.user == user %}vous avez {% endif %} 
                    {% for f in followers %} 
                        {% if r.user.username == f.followed_user.username %} {{ r.followed_user.username }} a {% endif %}
                    {% endfor %}                          
                publié une revue 
                <p>(ID : {{ r.id }})</p> 
                <p>{{ r.time_created }} </p> 
                <p>{{ r.headline }} - {{ r.rating }} </p> 
                <p>{{ r.body }} </p> 
                <p><a href="{# % url 'edit-review' review_id=t.id % #}">Modifier</a> </p> 

                <div class="ticket"> 
                    <p>{{ r.ticket.title }} (ID : {{ r.ticket.id }})</p> 
                    <p>{{ r.ticket.time_created }} </p> 
                    <p>{{ r.ticket.description }} </p> 
                    <p><img src="../../../reviews/images/{{ r.ticket.image }}" alt="Image ticket {{ r.ticket.id }}" height="100px"> </p> 
                    <p><a href="{# % url 'edit-ticket' ticket_id=t.id % #}">Modifier</a> </p> 
                </div>
            </div> 
        {% empty %} 
            <p>Il n'y a pas de revue </p> 
        {% endfor %} 
    </div> 

    <div class="cadre"> 
        {% for t in tickets %}
        <div class="ticket"> 
            <p>{{ t.title }} (ID : {{ t.id }})</p> 
            <p>{{ t.time_created }} </p> 
            <p>{{ t.description }} </p> 
            <p><img src="../../../reviews/images/{{ t.image }}" alt="Image ticket {{ t.id }}" height="100px"> </p> 
            <p><a href="{# % url 'edit-ticket' ticket_id=t.id % #}">Modifier</a> </p> 
        </div> 
        {% empty %} 
            <p>Il n'y a pas de ticket </p> 
        {% endfor %} 
    </div> 
    
    <div> 
        {% for f in followers %}
        <ul>
            <li>
                relation ID : {{ f.id }} <br> 
                Suiveur : {{ f.user.username }} (ID {{ f.user_id }}) <br> 
                Suivi : {{ f.followed_user.username }} (ID {{ f.followed_user_id }}) <br> 
            </li>
        </ul> 
        {% empty %} 
            <p>Il n'y a pas d'abonnement ni d'abonné </p> 
        {% endfor %}
    </div>

{% endblock content %} 


{% comment %}
+ home page (= flow page) 
    + boutons 
    + Flux des "?" des gens qu'on suit : 
        + Cadre 1 : 
            - "Vous avez publié une critique" (left) 
            - date - heure (right) 
            - note *** voir si je mets des "comms" par note *** 
            - Commentaire 
            + Cadre 11 : 
                - "Ticket - username" 
                - titre - auteur 
                - image 
        + Cadre 2 : 
            - "username a demandé une critique" (left) 
            - date - heure (right) 
            - Titre - auteur 
            - (image) 
            - bouton "Créer une critique" 
            - Bloquer la création d'une critique s/ un ticket si déjà faite 
{% endcomment %} 

{% comment %} 
    {% for ot in ots %} 
    <!-- {{ ot.id }}  -->
    {% if '023' not in ot.id and '045' not in ot.id %} <!-- if doc.document_url|slice:":7" == 'images/' /  --> 
    <div class="one_ot">
        <h3>
            <a href="{% url 'work_order_detail' work_order_id=ot.id %}" class="list-group-item list-group-item-action gap-3 py-3" aria-current="true">
                {{ ot.racine }}{{ ot.id }} - {{ ot.label }}  
            </a> 
        </p> 
        <p>{{ ot.address.number }} {{ ot.address.street_name }}<br>  
            {{ ot.address.zip_code }} {{ ot.address.city }}<br>
            <br> 
            <span class="mb-0 opacity-75">Localisation : 
                <a class="no-block" target="_blank" href="https://www.openstreetmap.org/#map=16/{{ ot.address.lng }}/{{ ot.address.lat }}">
                    Open Street Map
                </a>
            </span> 
        </p> 
        <div id="map"></div>
    </div> 
    <hr> 
    {% endif %} 
    {% endfor %} 
{% endcomment %}



